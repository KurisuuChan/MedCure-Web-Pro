<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Transaction Editing Debug Helper</title>
    <style>
      body {
        font-family: Arial, sans-serif;
        margin: 20px;
        background: #f5f5f5;
      }
      .container {
        max-width: 800px;
        background: white;
        padding: 20px;
        border-radius: 8px;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
      }
      .debug-section {
        margin: 20px 0;
        padding: 15px;
        border-left: 4px solid #3b82f6;
        background: #f8fafc;
      }
      .button {
        background: #3b82f6;
        color: white;
        padding: 10px 20px;
        border: none;
        border-radius: 4px;
        cursor: pointer;
        margin: 5px;
      }
      .button:hover {
        background: #2563eb;
      }
      .status {
        padding: 10px;
        margin: 10px 0;
        border-radius: 4px;
      }
      .success {
        background: #d1fae5;
        color: #065f46;
        border: 1px solid #a7f3d0;
      }
      .error {
        background: #fee2e2;
        color: #991b1b;
        border: 1px solid #fca5a5;
      }
      .info {
        background: #dbeafe;
        color: #1e40af;
        border: 1px solid #93c5fd;
      }
      pre {
        background: #1f2937;
        color: #f9fafb;
        padding: 15px;
        border-radius: 4px;
        overflow-x: auto;
      }
      .step {
        margin: 15px 0;
        padding: 10px;
        border: 1px solid #e5e7eb;
        border-radius: 4px;
      }
    </style>
  </head>
  <body>
    <div class="container">
      <h1>üîß Transaction Editing Debug Helper</h1>

      <div class="status info">
        <strong>Debug Helper Active!</strong> Use this page to test transaction
        editing functionality.
      </div>

      <div class="debug-section">
        <h3>üìã Testing Steps</h3>

        <div class="step">
          <h4>Step 1: Open POS Page</h4>
          <button class="button" onclick="openPOSPage()">Open POS Page</button>
          <p>
            Navigate to the POS page where transaction history is displayed.
          </p>
        </div>

        <div class="step">
          <h4>Step 2: Toggle Transaction History</h4>
          <p>
            Look for a "Transaction History" button or similar control to show
            recent transactions.
          </p>
        </div>

        <div class="step">
          <h4>Step 3: Find Edit Buttons</h4>
          <button class="button" onclick="findEditButtons()">
            Check Edit Buttons
          </button>
          <p>
            Look for Edit buttons (pencil icons) next to recent transactions.
          </p>
        </div>

        <div class="step">
          <h4>Step 4: Test Edit Functionality</h4>
          <button class="button" onclick="testEditModal()">
            Test Edit Modal
          </button>
          <p>
            Click an edit button and verify the modal opens with transaction
            data.
          </p>
        </div>
      </div>

      <div class="debug-section">
        <h3>üîç Debug Console Output</h3>
        <div id="console-output">
          <pre id="debug-log">Waiting for debug output...</pre>
        </div>
        <button class="button" onclick="clearLog()">Clear Log</button>
      </div>

      <div class="debug-section">
        <h3>üõ† Quick Actions</h3>
        <button class="button" onclick="runAllChecks()">Run All Checks</button>
        <button class="button" onclick="checkServerStatus()">
          Check Server Status
        </button>
        <button class="button" onclick="viewTestData()">View Test Data</button>
      </div>

      <div class="debug-section">
        <h3>üìä Expected Results</h3>
        <div class="status success">
          <strong>‚úÖ Success Indicators:</strong><br />
          ‚Ä¢ Transaction history loads with test transactions<br />
          ‚Ä¢ Edit buttons are visible and enabled for recent transactions<br />
          ‚Ä¢ Edit modal opens when clicking edit button<br />
          ‚Ä¢ Transaction data populates in the modal<br />
          ‚Ä¢ Debug logging appears in browser console
        </div>
      </div>
    </div>

    <script>
      let logElement = document.getElementById("debug-log");

      function log(message) {
        const timestamp = new Date().toLocaleTimeString();
        const logLine = `[${timestamp}] ${message}`;
        logElement.textContent += logLine + "\n";
        console.log(logLine);
      }

      function clearLog() {
        logElement.textContent = "Debug log cleared...\n";
      }

      function openPOSPage() {
        log("üîó Opening POS page...");
        window.open("http://localhost:5175/pos", "_blank");
      }

      function findEditButtons() {
        log("üîç Checking for edit buttons in parent window...");

        // This would work if called from the POS page console
        log("üí° Run this in the POS page console:");
        log("   document.querySelectorAll('button[title*=\"Edit\"]').length");
      }

      function testEditModal() {
        log("üß™ Testing edit modal functionality...");
        log("üí° Click an edit button on the POS page and check:");
        log("   - Modal opens");
        log("   - Transaction data loads");
        log("   - Console shows debug output");
      }

      function runAllChecks() {
        log("üöÄ Running all transaction editing checks...");
        log("1. Server should be running on port 5175");
        log("2. POS page should load transaction history");
        log("3. Edit buttons should be visible");
        log("4. Modal should open when clicking edit");

        checkServerStatus();
      }

      function checkServerStatus() {
        log("üåê Checking server status...");
        fetch("http://localhost:5175/")
          .then((response) => {
            if (response.ok) {
              log("‚úÖ Server is running on port 5175");
            } else {
              log("‚ùå Server responded with error: " + response.status);
            }
          })
          .catch((error) => {
            log("‚ùå Cannot reach server: " + error.message);
            log("üí° Make sure to run: npm run dev");
          });
      }

      function viewTestData() {
        log("üìä Test data should include:");
        log("   - Test Customer (2 hours ago) - EDITABLE");
        log("   - Old Customer (25 hours ago) - NOT EDITABLE");
        log("   - Both should have sale items");
        log("üí° Check database or POS transaction history");
      }

      // Initialize
      log("üîß Transaction Editing Debug Helper loaded");
      log("üéØ Next: Open POS page and test edit functionality");

      // Auto-check server status
      setTimeout(checkServerStatus, 1000);
    </script>
  </body>
</html>
